---
tags:
    - gemini
    - javascript
---

> [!quote]+ Prompt
> `const iter = [1,2,3,4,5][Symbol.iterator]();`
> この書き方は一体なんだ？どうなってるの？

これは、**イテレーターを直接取得する**ための書き方だよ。

---

### `[1,2,3,4,5][Symbol.iterator]()` の意味 ✨

まず、この式を分解して見ていこう。

1. **`[1,2,3,4,5]`**:
    
    - これは、5つの要素を持つ**配列リテラル**だね。配列は、JavaScriptにおいて**イテラブル（Iterable）**なオブジェクトの代表例だよ。
        
2. **`[Symbol.iterator]`**:
    
    - これは、`[1,2,3,4,5]`という配列に対して、`Symbol.iterator`という特別なキーを使ってプロパティにアクセスしているんだ。
        
    - `Symbol.iterator`は、**イテレーターを返すメソッド**が格納されている、組み込みの`Symbol`だよ。
        
    - だから、`[1,2,3,4,5][Symbol.iterator]` は、`[1,2,3,4,5].values()` のような**イテレーターを返すメソッドへの参照**を意味する。
        
3. **`()`**:
    
    - 最後に`()`を付けることで、そのメソッドを実行しているんだ。
        
    - `[1,2,3,4,5][Symbol.iterator]()` は、配列の**イテレーターオブジェクト**を生成して返す。
        

### どうなっているの？

まとめると、この書き方は**「配列リテラルから、そのイテレーターを返すメソッドを直接呼び出して、イテレーターオブジェクトを取得している」**ということになる。

このイテレーターオブジェクトは、`next()`メソッドを持っていて、`next()`を呼び出すたびに配列の次の要素を返すんだ。

JavaScript

```
const arr = [1, 2, 3, 4, 5];
const iter = arr[Symbol.iterator]();

console.log(iter.next()); // { value: 1, done: false }
console.log(iter.next()); // { value: 2, done: false }
console.log(iter.next()); // { value: 3, done: false }
console.log(iter.next()); // { value: 4, done: false }
console.log(iter.next()); // { value: 5, done: false }
console.log(iter.next()); // { value: undefined, done: true }
```

### なぜこんな書き方をするのか？

これは、**`for...of` ループの内部的な仕組み**を理解する上で非常に重要だよ。

`for...of`ループは、以下のような処理を自動でやってくれるんだ。

1. ループ対象のオブジェクトから、`Symbol.iterator`メソッドを呼び出して**イテレーターを取得する**。
    
2. イテレーターの`next()`メソッドを繰り返し呼び出す。
    
3. `next()`が返すオブジェクトの`done`プロパティが`true`になるまでループを続ける。
    

だから、君の書いたコードは、`for...of`ループが内部で行っている処理を、手動で再現しているもの、と言えるんだ。